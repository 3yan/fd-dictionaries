<!-- <?xml version='1.0' encoding="UTF-8" ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
               "/usr/share/sgml/docbook/dtd/xml/4.2/docbookx.dtd" [
<!ENTITY fdictUrl "http://www.freedict.org">
<!ENTITY fdictMail " freedict-beta@lists.sourceforge.net" >
<!ENTITY MichEmail "bunk@imn.htwk-leipzig.de" >
<!ENTITY PeteEmail  "petergozz@users.sf.net">

 ]>-->
<!-- COMMENT OUT EVERYTHING above HERE  TO BUILD -->


<chapter id="writing">
  <title>Writing a FreeDict Dictionary</title>
  <abstract>
    <para>This begins a series of sections that deal with the process of building
      a FreeDict format file from your gathered sources. We cover installation,
      SGML and XML system configuration, some introductory level XML, final formats
      and a couple of shortcuts.
    </para>
  </abstract>
  <section>
    <title>Introduction</title>
    <para>What we don't deal with here is the actual process of collating a
      translating dictionary. That task is potentially endless and will be
      very particular to your own circumstances. You need to develop your own
      approaches and processes for gathering source materials and checking the
      quality of your entries. Here are some of the "process" things you might
      look out for and check with small sample sets before you get too far along.</para>
    <orderedlist numeration="upperalpha">
      <listitem>
        <para>Your editor or word processor can output UTF-8 format TEXT - not word
          processor or browser specific markup, nor anything other than simple text that
          can handle the characters of the languages you are writing for. Using different
          fonts, while helpful in a word processor, generally won't work in plain text
          (or UTF-8) format. In your final output version it almost certainly wont.
          <indexterm><primary>word processor</primary></indexterm>
  	  <indexterm><primary>fonts</primary></indexterm>
	</para>
      </listitem>
      <listitem>
	<para>If you are importing from a spreadsheet application, try exporting the pages
          as simple Comma Separated Value format. You can often use almost any character or
          set of characters as a "comma". You may be able to convert it to Dictd format with
          a simple script (in which case we have a shortcut for you). <xref linkend="dictd" />
	  <indexterm><primary>spreadsheet</primary></indexterm>
	</para>
      </listitem>
      <listitem>
	<para>If you are starting from scratch and writing your dictionary mostly by hand,
          please consider using a template, and an XML editor like (X)emacs. These make the
          process much less error prone and tedious. See the <link linkend="tools">tools section</link>
          for more information.
	  <indexterm>
            <primary> XML</primary>
            <secondary>Editor</secondary>
	    <tertiary>Xemacs and emacs</tertiary>
          </indexterm>
          <indexterm>
            <primary>writing</primary>
            <secondary>by hand</secondary>
          </indexterm>
          <indexterm>
	    <primary>Starting from Scratch</primary>
	  </indexterm>
	  <indexterm>
	    <primary>CSV</primary>
	    <secondary>Comma Separated Value</secondary>
	  </indexterm>
        </para>
      </listitem>
    </orderedlist>

    <section>
      <title>Two Approaches</title>
	  
      <para>There are at least two approaches you might take to building a FreeDict format dictionary.
        <link linkend="write-tei">Approach One</link> is to use the Text Encoding Initiative DTD from
        the beginning. This gives you the most flexibility.</para>
      <para><link linkend="dictd">Approach Two</link> involves producing a simply (and accurately)
        formatted plain file that you then process with some command lines tools (and will probably
        have to touch up). This can be quicker if you are comfortable with it, but may limit your
        options for lexicographic information.</para>
      <para>You may of course combine these or find any number of others, after all, it's your
        dictionary we just need it in a certain format :)
	<indexterm>
	  <primary>lexicographic</primary>
	  <secondary>flexibility</secondary>
	</indexterm>
        <indexterm>
	  <primary>Text Encoding Initiative</primary>
	  <secondary>DTD</secondary>
	</indexterm>
	<indexterm>
	  <primary>File Formats</primary>
	</indexterm>
      </para>	 
    </section>	 
  </section>

</chapter>

<chapter id="write-tei">
  <title>Writing Text Encoding Initiative XML files</title>
  <abstract>
    <formalpara>
      <title>The Text Encoding Initiative</title>
      <para>
        <quote>The TEI (Text Encoding Initiative) is an international research effort
          established in 1987, intended to produce a community-based standard for encoding
          and interchange of texts.</quote>
        <citation><ulink url="http://www.tei-c.org/Consortium/TEIcharter.html">http://www.tei-c.org/Consortium/TEIcharter.html</ulink></citation>
      </para>
    </formalpara>
    <para>This section gives examples and explanations of using the TEI format to write and
      deliver your dictionary. While it is not assumed you have the <link linkend="installTeiDTD">DTDs installed</link>,
      it may be best if you did.
      <indexterm>
        <primary>TEI</primary>
	<secondary>Text Encoding Initiative</secondary>
      </indexterm>
      <indexterm>
	<primary>TEI Consortium</primary>
      </indexterm>
    </para>
  </abstract>

  <section id="overview-tei">
    <title>Overview of the TEI Organisation</title>
    <formalpara>
      <title>In Brief:</title>
      <para>
        <quote>In December of 2000, a new consortium was established to sustain
          and develop the Text Encoding Initiative (TEI). Initially launched in 1987,
          the TEI is an international and interdisciplinary standard that helps libraries,
          museums, publishers, and individual scholars represent all kinds of literary and
          linguistic texts for online research and teaching, using an encoding scheme that
          is maximally expressive and minimally obsolescent.</quote>
        <citation><ulink url="http://www.tei-c.org/Consortium/index.html">http://www.tei-c.org/Consortium/index.html</ulink></citation>
        <indexterm>
	  <primary>interdisciplinary standards</primary>
	</indexterm>
      </para>
    </formalpara>

    <para>For a full explanation of the history, objectives and approaches of the Text Encoding Initiative
      it would be best if you visited them at <ulink url="&TEIUrl;">&TEIUrl;</ulink>. There you will find
      links and information to all sorts of TEI related stuff. Of note are the <ulink url="&TEIguide;">Guidelines</ulink>.</para>
    <para>The TEI consortium provides an approach to transcribing and creating documents in a format that
      allows (near) full XML and SGML compliance, is as obsolescence proof as possible and allows free
      exchange of content and ideas. We will only be using a very small subset of this system's capacity.
      <indexterm>
	<primary>obsolescence proofing</primary>
      </indexterm>
    </para>
  </section>

  <section id="UsingTEI">
    <title>The TEI DTDs</title>
    <subtitle> Using The TEI Dictionary DTD</subtitle>
    <para>In these sections we are going to step through a basic introduction
      to building a marked up dictionary based on the Text Encoding Initiative
      TEI2 P4 Dictionary Document Type Definition. First we deal with some
      technical information. If you are familiar with XML and DTDs, you might
      want to skip these next sections.
    </para>
    <para>The Install Instructions are dealt with separately. Please see <xref linkend="installTeiDTD"/>
    </para>
    <para>The TEI system of markup can be approached in a number of ways. Here
      we treat it pretty much like any other XML based markup system. The consortium
      itself has not registered a formal XML name space (as of Feb 2004), but does have
      unofficial Public and System identifiers we may use. If you don't know what all that
      means, don't worry. Cut and paste examples are given below. While, in the following
      "Walking with" section there are some basic explanations of what this all means. For
      a deeper understanding a visit to the W3C XML pages may help. OASIS and associated XML
      portals usually have technical and introductory matter as well.</para>
    <para><ulink url="&w3c;">&w3c;</ulink></para>
    <para><ulink url="&oasiscover;">&oasiscover;</ulink></para>
    <para><ulink url="http://www.xml.com/">http://www.xml.com</ulink>
      <indexterm>
        <primary>OASIS</primary>
        <secondary>W3C</secondary>
      </indexterm>
    </para>
  </section>

  <section id="xmldecTEI">
    <title>The XML Declaration</title>
    <para>&lt;?xml version='1.0' encoding="UTF-8" ?&gt;</para>
    <para>The xml declaration is required on all valid xml documents. For our purposes the above is all we need, be aware though, that this declaration can contain much more than we use here. The "encoding="UTF-8""<emphasis> attribute and value pair</emphasis> is sometimes considered optional as all XML documents assume or default to this unless told otherwise. I believe it is better to add it now as future implementations of XML will probably require it.</para>
    <para>It is the next section that defines our Text Encoding Initiative format in particular. So far we have just told a validating application or parser that this document should be valid XML version 1.<indexterm>
	<primary>XML Declaration</primary>
      </indexterm>
    </para>
  </section>

    <section id="doctypeTEI">
      <title>The SGML Declaration</title>   
    <para><literallayout>&lt;!DOCTYPE TEI.2 PUBLIC &TEIsys; 
"http://www.tei-c.org/P4X/DTD/tei2.dtd" [
 &lt;!ENTITY % TEI.XML          "INCLUDE" &gt;
 &lt;!ENTITY % TEI.dictionaries "INCLUDE" &gt;
      ]&gt;</literallayout></para>
    <para> This above  section is called the DOCTYPE declaration. The UPPER case words are all keywords that are used to set variables and types in parsing and validating tools. The rest of the definition is very carefully structured to provide absolute definitions for a number of things. We step through them here, as they are understood by the protocols involved. The entire set between the opening &lt;! and the closing &gt; is called the document prolog. Functionally it defines or even redefines a specific named document type.
      <indexterm>
	<primary>DOCTYPE</primary>
	<secondary>SGML</secondary>
      </indexterm> 
      <indexterm>
	<primary>TEI.XML</primary>
      </indexterm>
      <indexterm>
	<primary> TEI.dictionaries</primary>
      </indexterm>
      <indexterm>
	<primary>document prolog</primary>
	<secondary>INCLUDES</secondary>
      </indexterm>
 </para>
    <section id="TEIdoctype">
      <title>&lt;!DOCTYPE TEI.2</title>
      <para>The combined effect of this declaration opening string is to tell a program (or person) who knows, that this document is claiming to be compliant to a<emphasis> defined type of document</emphasis>. In our case TEI.2.</para><para> Other document types (e.g.<application> DocBook</application>) use this parameter to set the "level" the document sits at, possibly within a larger definition. Text Encoding Initiative documents use a different system to achieve much the same end. (see the following description of ENTITIES.)<indexterm>
	  <primary>DocBook </primary>
	</indexterm>
</para>

    <para>Practically, another way of thinking about this is to consider that the opening ELEMENT  of the following document has to be of the type TEI.2. What that element is allowed to have as attributes or children elements is defined in the Document Type Definition for this DOCTYPE. <indexterm>
	<primary>ELEMENT </primary>
      </indexterm>
</para>
    </section>
    <section id="TEIFPIid">
      <title> PUBLIC "&TEIsys;"</title>
      <para>This next "phrase" is called the Formal Public Identifier. It starts with the word PUBLIC and in this case ends with a language identifier. The quoting is important as is the string -// at the start of the actual definition. </para> <para>This means that this is an informal definition, or an unregistered definition. A registered definition would start start with +//. Most Formal Public Identifiers use this type of definition, there is nothing unusual or pejorative about it. <indexterm>
	<primary> PUBLIC "&TEIsys;"</primary>
	</indexterm>
	<indexterm>
	  <primary> Formal Public Identifiers</primary>
	  <secondary>FPI</secondary>
	</indexterm>
 </para>
	<para>The FPI must be exactly as shown or it means <quote>something else</quote>, and probably not what we need it to. It is also one of the ways your <link linkend="catalog-setup">local system</link> knows which DTD to compare your document to, and so must be correct.</para>
<note>
	  <para>Text Encoding Initiative documents<emphasis> also use other FPI's</emphasis> to define document "types" or "classes". If you visit their website you will see many other examples. The TEI2 zip file currently has HTML documentation explaining all those options, as that is likely to be up to date please refer to it rather than this for usages<emphasis> other than Freedict</emphasis>. Please see <xref linkend="findingTEI" /> if you haven't already :) </para>
</note>
    </section>
    <section id="TEIsystemid">
      <title>"http://www.tei-c.org/P4X/DTD/tei2.dtd"</title>
      <para>This next string must be a URI (Universal Resource Identifier (RFC 1630)) in this case it is in URL ( Uniform Resource Locator ( RFC 1738))  format. Here it functions as a portable  System Identifier to the DTD. By convention it is often started on a new line, that is not a requirement.</para>
    <para> This is just one way of doing this, and you may simply set the absolute path to the DTD on your system here and it should be OK. If you choose to install the DTD's only for your own use you must set the system identifier to the absolute path to your copy of the DTD. <indexterm>
	  <primary> Uniform Resource Locator</primary><secondary>URL</secondary>
      </indexterm><indexterm>
	<primary>Universal Resource Identifier </primary><secondary>URI</secondary>
      </indexterm>
</para>
<example id="ownDTD"><title> System Identifiers</title>
	<para><literallayout>&lt;!DOCTYPE TEI.2 PUBLIC "&TEIsys;" 
"/home/your-account/TEI/TEI2.dtd" [
 &lt;!ENTITY % TEI.XML          "INCLUDE" &gt;
 &lt;!ENTITY % TEI.dictionaries "INCLUDE" &gt;
	]&gt;  

	  </literallayout><indexterm>
	    <primary>System Identifier </primary>
	  </indexterm>
	</para></example>
      <para>Be aware that this method in not portable and  will need to be changed to the URL shown above for broad use. (i.e. The URL method is portable). It may save you a whole lot of bother if you don't plan on using the TEI2 DTD for much else other than Freedict.<indexterm><primary>Portability</primary></indexterm></para>
    </section>
    <section>
      <title> &lt;!ENTITY % TEI.dictionaries "INCLUDE" &gt;
	]&gt; </title>
      <para>The final section of the DOCTYPE declaration is also enclosed between square brackets. For our purposes here we simply use it to Include some ENTITIES. In this case these entities are contained within files that are a part of the TEI2 P4 DTD set.  </para> 
      <para>The first inclusion  &lt;!ENTITY % TEI.XML          "INCLUDE" &gt; does some very clever "magic" remapping the DTD to XML compliant form. Without it the document will not be XML. </para>
      <para>The second included ENTITY :  &lt;!ENTITY % TEI.dictionaries "INCLUDE" &gt; adds the dictionary specific Elements to the base DTD, and thereby makes this a dictionary as opposed to say a stage script or process design document.</para>
      <para>You may define your own extensions to the TEI set within these square braces as well. The Freedict project can not support this. A careful study of the DTD's and associated files would be of great value if you are interested in gaining a greater understanding of SGML and XML. Functionally this space is where a DTD is loaded for any document type. (you may also include other files in this place which can be useful for large document sets.<indexterm><primary>ENTITIES</primary>
	</indexterm>
      </para>
    </section>
  </section>
  <section id="headerTEI">
    <title>The TEI Header</title>
    <abstract>
      <para>In this section we step through the structure and intent behind the TEI header section.</para>
    </abstract>
    <para>Headers usually give meta information, ie. information about something. The TEI header gives
      general information about the following text like title, authors, publisher, revision history.
      It is defined in <ulink url="http://www.tei-c.org/P4X/HD.html">The TEI Guidelines, Chater 5</ulink>.
    </para>

    <para>At present the only tool that makes use of the header in TEI dictionary files is the converter
      <link linkend="tei2dict"><application>xmltei2xmldict.pl</application></link> by transforming it into the 00-database-info entry
      in the dictd database files, if a style sheet is used that makes use of the header. The contents of the title
      element go into the 00-database-short entry; the content of the sourceDesc element go into the
      00-database-url entry. That is all.</para>

    <para>In the following you find a header taken from the <filename>kha-deu.tei</filename> file. You can copy
      it and replace element contents as they fit your database.</para>

    <para><!-- warning replace &lt; and %gt; with < and > if copying from XML source -->
    <blockquote><literallayout><computeroutput>
  &lt;teiHeader&gt;                                                                                       
    &lt;fileDesc&gt;                                                                                      
      &lt;titleStmt&gt;                                                                                   
        &lt;title&gt;Khasi-German Freedict Dictionary&lt;/title&gt;
        &lt;respStmt&gt;                                                                                  
          &lt;resp&gt;Khasi Databases Maintainer&lt;/resp&gt;
          &lt;name&gt;Michael Bunk, micha@luetzschena.de&lt;/name&gt;                                           
        &lt;/respStmt&gt;                                                 
      &lt;/titleStmt&gt;                                                                                  
      &lt;editionStmt&gt;                                                                                 
        &lt;edition&gt;2nd. Online Draft&lt;/edition&gt;                                                        
      &lt;/editionStmt&gt;                                                                                
      &lt;publicationStmt&gt;                                                                             
        &lt;publisher&gt;freedict.de&lt;/publisher&gt;                                                          
        &lt;date&gt;2002-2003&lt;/date&gt;                                                                      
        &lt;availability&gt;                                                                              
          &lt;p&gt;GNU GENERAL PUBLIC LICENSE&lt;/p&gt;                                                         
        &lt;/availability&gt;                                                                             
      &lt;/publicationStmt&gt;                                                                            
      &lt;seriesStmt&gt;                                                                                  
        &lt;title&gt;free dictionaries&lt;/title&gt;                                                            
      &lt;/seriesStmt&gt;                                                                                 
      &lt;notesStmt&gt;                                                                                   
        &lt;note&gt;Thanks go to the supporters of this project:                                          
        Karl-Heinz Gr&uuml;&szlig;ner, University of T&uuml;bingen; Rebekah Tham,                                
        CIEFL, Shillong; Brother Sngi, Sacred Heart College,                                        
        Shillong; University of Leipzig, Depts of Indology and                                      
        Computer Science; Rik Faith for dictd server &amp;amp;                                          
        protocol; TEI for their wonderful guidelines; Horst                                         
        Eyermann for his generous freedict project; the open source                                 
        community: thrust for trust &amp;amp; development&lt;/note&gt;                                        
      &lt;/notesStmt&gt;                                                                                  
      &lt;sourceDesc&gt;                             
        &lt;p&gt;http://www.freedict.de/&lt;/p&gt;                                                              
      &lt;/sourceDesc&gt;                                                                                 
    &lt;/fileDesc&gt;                                                                                     
    &lt;revisionDesc&gt;                                                                                  
      &lt;change&gt;                                                                                      
        &lt;date&gt;01. May 2003&lt;/date&gt;                                                                   
        &lt;respStmt&gt;                                                                                  
          &lt;name&gt;Michael Bunk&lt;/name&gt;                                                                 
        &lt;/respStmt&gt;                                                                                 
        &lt;item&gt;Updated some things in XML header information&lt;/item&gt;                                  
      &lt;/change&gt;                                                                                     
      &lt;change&gt;                                                                                      
        &lt;date&gt;18. February 2002&lt;/date&gt;                                                              
        &lt;respStmt&gt;                                                                                  
          &lt;name&gt;Michael Bunk&lt;/name&gt;                                                                 
        &lt;/respStmt&gt;                                                                                 
        &lt;item&gt;First Draft&lt;/item&gt;                                                                    
      &lt;/change&gt;                                                                                     
      &lt;change&gt;                                                                                      
        &lt;date&gt;before February 2002&lt;/date&gt;                                                           
        &lt;respStmt&gt;                                                                                  
          &lt;name&gt;Karl-Heinz Gr&uuml;&szlig;ner&lt;/name&gt;                                                         
        &lt;/respStmt&gt;                                  
        &lt;item&gt;compilation of wordlists&lt;/item&gt;                                                       
      &lt;/change&gt;                                                                                     
    &lt;/revisionDesc&gt;                                                                                 
  &lt;/teiHeader&gt;
    </computeroutput></literallayout></blockquote></para>

    <para>That header is transformed to this 00-database-info text:</para>

    <para><blockquote><literallayout><computeroutput>
Khasi-German Freedict Dictionary                                                                    
                                                                                                    
Khasi Databases Maintainer: Michael Bunk, micha@luetzschena.de                                      
                                                                                                    
Edition: 2nd. Online Draft                                                                          
                                                                                                    
Published by: freedict.de, 2002-2003                                                                
                                                                                                    
Series: free dictionaries                                                                           
                                                                                                    
Notes:                                                                                              
                                                                                                    
* Thanks go to the supporters of this project: Karl-Heinz Grüßner,
University of T&uuml;bingen; Rebekah Tham, CIEFL, Shillong; Brother Sngi,                               
Sacred Heart College, Shillong; University of Leipzig, Depts of                                     
Indology and Computer Science; Rik Faith for dictd server &amp; protocol;                               
TEI for their wonderful guidelines; Horst Eyermann for his generous                                 
freedict project; the open source community: thrust for trust &amp;                                     
development                                                                                         
                                                                                                    
Source: http://www.freedict.de/                                                                     
                                                                                                    
Changelog:                                                                                          
                                                                                                    
* Mon Feb 23 23:03:30 2004 tei2dictxml_xml.pl: converted TEI database                               
into .dict format                                                                                   
                                                                                                    
* 01. May 2003 Michael Bunk: Updated some things in XML header                                      
information                                                                                         
                                                                                                    
* 18. February 2002 Michael Bunk: First Draft                                                       
                                                                                                    
* before February 2002 Karl-Heinz Grüßner: compilation of wordlists
    </computeroutput></literallayout></blockquote></para>

  </section>

<!-- move this -->
  <section id="templates">
    <title>Examples and Templates</title>
    <para>Move this somewhere useful</para>
  </section>
</chapter>
 
<!-- Keep this comment at the end of the file. It is for emacs.
 Local Variables:
 sgml-parent-document: ("freedicthowto.xml" "book" "chapter")
 End:
 -->
